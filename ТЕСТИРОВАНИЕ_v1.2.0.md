# Чеклист тестирования v1.2.0

## Подготовка к тестированию

- [ ] Сделана резервная копия базы данных
- [ ] Сделана резервная копия файлов плагина
- [ ] Плагин обновлён до версии 1.2.0

## Тест 1: Проверка интерфейса настроек

### Шаги:
1. Откройте **WooCommerce → Поля XML**
2. Проверьте таблицу "Общие поля (для всех объявлений)"

### Ожидаемый результат:
- [ ] Таблица содержит колонку "Условие генерации"
- [ ] В колонке есть поле ввода с плейсхолдером
- [ ] Под полем ввода есть подсказка с примерами
- [ ] Информационный блок вверху страницы обновлён и содержит информацию об условиях

## Тест 2: Добавление нового поля с условием

### Шаги:
1. На странице **WooCommerce → Поля XML**
2. Нажмите кнопку "Добавить поле" под таблицей глобальных полей
3. Заполните новое поле:
   - Название XML тега: `TestField`
   - Значение: `Test Value`
   - Условие: `{product_price}>100`
   - Тип: `text`
   - Включено: ✓

### Ожидаемый результат:
- [ ] Новая строка добавлена в таблицу
- [ ] Все поля корректно отображаются
- [ ] Поле условия содержит введённое значение

## Тест 3: Сохранение настроек

### Шаги:
1. После добавления поля из Теста 2
2. Нажмите "Сохранить настройки полей"
3. Обновите страницу

### Ожидаемый результат:
- [ ] Показано сообщение "Настройки полей сохранены"
- [ ] После перезагрузки страницы поле с условием присутствует
- [ ] Условие сохранилось корректно

## Тест 4: Условие "равно" (=)

### Подготовка:
- Создайте тестовую категорию "Тестовая"
- Добавьте товар в эту категорию с ценой 1000₽

### Шаги:
1. Создайте глобальное поле:
   - XML тег: `CategoryTest`
   - Значение: `Это товар из тестовой категории`
   - Условие: `{category_name}=Тестовая`
2. Сгенерируйте XML
3. Откройте XML файл

### Ожидаемый результат:
- [ ] Поле `<CategoryTest>` присутствует только у товаров из категории "Тестовая"
- [ ] У товаров из других категорий этого поля нет

## Тест 5: Условие "больше" (>)

### Шаги:
1. Создайте глобальное поле:
   - XML тег: `ExpensiveProduct`
   - Значение: `Дорогой товар`
   - Условие: `{product_price}>5000`
2. Сгенерируйте XML
3. Откройте XML файл

### Ожидаемый результат:
- [ ] Поле присутствует только у товаров с ценой > 5000
- [ ] У товаров с ценой ≤ 5000 этого поля нет

## Тест 6: Условие "содержит" (contains)

### Шаги:
1. Создайте товар с названием "Кирпич красный М-150"
2. Создайте глобальное поле:
   - XML тег: `BrickProduct`
   - Значение: `Это кирпич`
   - Условие: `{product_name} contains кирпич`
3. Сгенерируйте XML

### Ожидаемый результат:
- [ ] Поле присутствует у товаров, в названии которых есть слово "кирпич"
- [ ] Регистр не важен (работает для "Кирпич", "кирпич", "КИРПИЧ")

## Тест 7: Условие "не равно" (!=)

### Шаги:
1. Создайте глобальное поле:
   - XML тег: `NotTestCategory`
   - Значение: `Не тестовая категория`
   - Условие: `{category_name}!=Тестовая`
2. Сгенерируйте XML

### Ожидаемый результат:
- [ ] Поле присутствует у всех товаров, кроме категории "Тестовая"

## Тест 8: Пустое условие (без ограничений)

### Шаги:
1. Создайте глобальное поле:
   - XML тег: `AlwaysPresent`
   - Значение: `Всегда показывается`
   - Условие: (оставить пустым)
2. Сгенерируйте XML

### Ожидаемый результат:
- [ ] Поле присутствует у ВСЕХ товаров в XML

## Тест 9: Использование плейсхолдеров в условии

### Шаги:
1. Создайте товар с мета-полем `_stock_status` = `instock`
2. Создайте глобальное поле:
   - XML тег: `InStockOnly`
   - Значение: `В наличии`
   - Условие: `{meta:_stock_status}=instock`
3. Сгенерируйте XML

### Ожидаемый результат:
- [ ] Поле присутствует только у товаров со статусом "в наличии"

## Тест 10: Обратная совместимость

### Шаги:
1. Откройте существующие глобальные поля (созданные до обновления)
2. Проверьте их работу после обновления

### Ожидаемый результат:
- [ ] Старые поля работают как раньше
- [ ] Поле "Условие генерации" для них пустое
- [ ] Они генерируются для всех товаров (как до обновления)

## Тест 11: Некорректное условие

### Шаги:
1. Создайте поле с некорректным условием: `неправильное условие без оператора`
2. Сгенерируйте XML
3. Проверьте логи WordPress (`wp-content/debug.log`)

### Ожидаемый результат:
- [ ] Поле НЕ добавляется в XML
- [ ] В логах есть сообщение об ошибке формата условия
- [ ] Генерация XML не прерывается

## Тест 12: Операторы сравнения (>=, <=)

### Шаги:
1. Создайте два поля:
   - Поле 1: Условие `{product_price}>=1000`
   - Поле 2: Условие `{product_price}<=5000`
2. Создайте товары с ценами: 500₽, 1000₽, 3000₽, 5000₽, 7000₽
3. Сгенерируйте XML

### Ожидаемый результат:
- [ ] Поле 1 присутствует у товаров с ценой ≥ 1000 (1000, 3000, 5000, 7000)
- [ ] Поле 2 присутствует у товаров с ценой ≤ 5000 (500, 1000, 3000, 5000)

## Тест 13: Оператор "не содержит" (!contains)

### Шаги:
1. Создайте поле:
   - Условие: `{product_name} !contains распродажа`
2. Создайте товары: "Кирпич обычный", "Кирпич распродажа"
3. Сгенерируйте XML

### Ожидаемый результат:
- [ ] Поле присутствует у товара "Кирпич обычный"
- [ ] Поле ОТСУТСТВУЕТ у товара "Кирпич распродажа"

## Тест 14: Производительность

### Шаги:
1. Добавьте 5-10 глобальных полей с разными условиями
2. Убедитесь, что в магазине есть минимум 100 товаров
3. Засеките время генерации XML

### Ожидаемый результат:
- [ ] Генерация XML завершается успешно
- [ ] Время генерации приемлемое (не более чем на 10-20% дольше чем без условий)
- [ ] XML файл корректен

## Итоговая проверка

### После всех тестов:
- [ ] Все существующие функции плагина работают
- [ ] XML генерируется корректно
- [ ] Условия работают как ожидается
- [ ] Нет критических ошибок в логах
- [ ] Интерфейс понятен и удобен

## Дополнительная информация

### Если тест провален:
1. Запишите шаги для воспроизведения
2. Проверьте логи WordPress
3. Проверьте версию плагина
4. Сообщите разработчику

### Логи для отладки:
Включите debug режим в `wp-config.php`:
```php
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
```

Логи будут в: `wp-content/debug.log`

---

**Дата тестирования:** _______________
**Тестировал:** _______________
**Результат:** ⬜ Успешно ⬜ С замечаниями ⬜ Провалено
**Комментарии:**

_______________________________________________
_______________________________________________
_______________________________________________
